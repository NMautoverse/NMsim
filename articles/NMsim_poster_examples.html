<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>NMsim - Seamless NONMEM Simulation Platform in R • NMsim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="NMsim - Seamless NONMEM Simulation Platform in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NMsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4.907</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/NMsim-basics.html">Simulation of New Subjects</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-VPC.html">Simulations for VPCs</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-config.html">Requirements and Configuration</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-known.html">Simulate Known Subjects</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-TypSubj.html">Simulate Typical Subjects</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-ParamUncertain.html">Simulations with Parameter Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-DataCreate.html">Creation of Simulation Data Sets</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-ResidVar.html">Simulation with Residual Variability</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-varyPars.html">Varying Parameter Values</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-ReuseSimSubjects.html">Reuse Simulated Subjects</a></li>
    <li><a class="dropdown-item" href="../articles/NMsim-speed.html">Debugging, Speed, and Disk Space</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/NMsim-publications.html">Publications</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NMautoverse/NMsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NMautoverse/NMsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NMsim - Seamless NONMEM Simulation Platform in R</h1>
                        <h4 data-toc-skip class="author">Philip
Delff</h4>
                        
            <h4 data-toc-skip class="date">November 09, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NMautoverse/NMsim/blob/main/vignettes/NMsim_poster_examples.Rmd" class="external-link"><code>vignettes/NMsim_poster_examples.Rmd</code></a></small>
      <div class="d-none name"><code>NMsim_poster_examples.Rmd</code></div>
    </div>

    
    
<style type="text/css">

body{
  font-size: 12pt;
}

h1.title {
  font-size: 24px;
  color: DarkRed;
  margin-top: 2em;
  margin-bottom: 1em;
}
h1 { /* Header 1 */
  font-size: 20px;
  color: DarkBlue;
}
h2 { /* Header 2 */
  margin-top: 1em;
  font-size: 20px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
h4 { /* Header 4 */
  font-size: 16px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
table.Rtable1 {
    font-size: 12px;
}

.superbigimage{
      overflow-x:scroll;
      white-space: nowrap;
  }

.superbigimage img{
     max-width: none;
  }
  
h4.author {
  font-weight:bold;
  font-style:italic;
  margin-top: 0em;
  margin-bottom: 1em;
}
h4.date {
  font-weight:bold;
  margin-top: 0em;
  margin-bottom: 5em;
}


/* -----------div tips------------- */

div.summary {
 padding: 1em;
 margin: 1em;
 padding-left: 50px;
 background-size: 30px;
 background-repeat: no-repeat;
 background-position: 10px 10px;
 min-height: 40px;
 font-size: 16px;
 color: #000000;
 background-color: #bed3ec;
 border: solid 5px #dfedff;
 /* background-image: url("Summary_ffffff.png"); */
}

div.data {
 padding: 1em;
 margin: 1em;
 padding-left: 50px;
 background-size: 30px;
 background-repeat: no-repeat;
 background-position: 10px 10px;
 min-height: 40px;
 font-size: 16px;
 color: #000000;
 background-color: #FAD07D;
 border: solid 5px #FFDE9C;
 /* background-image: url("Stats graph_ffffff.png"); */
}

</style>
<div class="section level2" number="1">
<h2 id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>While NONMEM offers great flexibility for estimation of PK and PK/PD
models, many users find the simulation features in NONMEM insufficient
and turn to alternative software for simulation. This leads to
additional work of model reimplementation, with risk of the simulation
model deviating from the estimated model, due to bugs in the
reimplementation. For a wide range of model types, the limitation is not
in NONMEM’s ability to perform such simulations, but rather in the lack
of a simple user-interface to obtain the simulations. <a href="https://cran.r-project.org/package=NMsim" class="external-link"><code>NMsim</code></a>
<span class="citation">[@R-NMsim]</span> provides such an interface as
an R package, allowing the modeler to simulate models as soon as an
estimate is available.</p>
</div>
<div class="section level2" number="2">
<h2 id="objectives">
<span class="header-section-number">2</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<p>The goal for NMsim is to automate the NONMEM simulation workflow and
provide a simple, flexible, and powerful R interface. With this
automation, post-processing of model estimates can to great extends be
automated.</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
NONMEM
</th>
<th style="text-align:left;">
Third-party
</th>
<th style="text-align:left;">
NMsim
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 12em; ">
Implementation
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: green !important;">Easy</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: red !important;">Depends - Potentially
error-prone</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: green !important;">None</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 12em; ">
Execution
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: red !important;">Tedious</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: green !important;">Easy</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: green !important;">Easy</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 12em; ">
Depends on NONMEM
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: orange !important;">Yes</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: green !important;">No</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: orange !important;">Yes</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 12em; ">
Runtime
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: orange !important;">Fair</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: green !important;">Fast</span>
</td>
<td style="text-align:left;width: 12em; ">
<span style="     color: orange !important;">Fair</span>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2" number="3">
<h2 id="methods">
<span class="header-section-number">3</span> Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p><code>NMsim</code> does not simulate, translate or otherwise
interpret a NONMEM model. Instead, it automates the NONMEM simulation
workflow (including execution of NONMEM) and wraps it all into one R
function. Provided with a path to a NONMEM control stream and a
data.frame to simulate, <code>NMsim</code> will do the following:</p>
<ul>
<li>Save the simulation input data in a csv file for NONMEM</li>
<li>Create a simulation input control stream based on
<code>file.mod</code> (<code>$INPUT</code> and <code>$DATA</code>
matching the saved simulation data set; <code>$SIMULATE</code> instead
of <code>$ESTIMATION</code> and <code>$COVARIANCE</code>)</li>
<li>Update and fix initial values based on estimate (from
<code>file.ext</code>)</li>
<li>Run NONMEM on the generated simulation control stream</li>
<li>Collect output data tables, combine them, and merge with the
simulation input data</li>
<li>Return the collected data in R</li>
</ul>
<p><code>NMsim</code> can call NONMEM directly or via <code>PSN</code>.
If <code>NMsim</code> is run on a system where NONMEM cannot be
executed, <code>NMsim</code> can still prepare the simulation control
stream and datafile.</p>
<p><code>NMsim</code> is in itself a relatively small R package. It
makes extensive use of functionality to handle NONMEM data and control
streams provided by the R package <a href="https://cran.r-project.org/package=NMdata" class="external-link"><code>NMdata</code></a>
<span class="citation">[@R-NMdata]</span>.</p>
</div>
<div class="section level2" number="4">
<h2 id="results">
<span class="header-section-number">4</span> Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>When providing a simulation data set, the default
<code><a href="../reference/NMsim.html">NMsim()</a></code> behavior is to sample a new subject (ETA’s).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/nonmem/xgxr021.mod"</span>,</span>
<span>                        package<span class="op">=</span><span class="st">"NMsim"</span><span class="op">)</span></span>
<span><span class="va">data.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/derived/dat_sim1.csv"</span>,</span>
<span>                                 package<span class="op">=</span><span class="st">"NMsim"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">simres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="va">file.mod</span>,data<span class="op">=</span><span class="va">data.sim</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="va">file.mod</span>,data<span class="op">=</span><span class="va">data.sim</span><span class="op">)</span></span>
<span><span class="va">datl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">simres</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span>measure.vars<span class="op">=</span><span class="fu">cc</span><span class="op">(</span><span class="va">PRED</span>,<span class="va">IPRED</span>,<span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">datl</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">TIME</span>,<span class="va">value</span>,colour<span class="op">=</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span><span class="op">[</span><span class="va">variable</span><span class="op">!=</span><span class="st">"Y"</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span><span class="op">[</span><span class="va">variable</span><span class="op">==</span><span class="st">"Y"</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Hours since first dose"</span>,y<span class="op">=</span><span class="st">"Concentration (ng/mL)"</span>,</span>
<span>         subtitle<span class="op">=</span><span class="st">"Simulation of one new subject."</span>,</span>
<span>         colour<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>Notice that no information about the model is needed except for the
control stream file path. The simulation is based on evaluation of
<code>PRED</code>, <code>IPRED</code>, and optionally <code>Y</code>.
Options exist for building more advanced simulation models. The models
shown here are based on data available in the <a href="https://cran.r-project.org/package=xgxr" class="external-link"><code>xgxr</code></a>
<span class="citation">[@R-xgxr]</span>.</p>
<div class="section level4" number="4.0.1">
<h4 id="generation-of-simulation-data-sets">
<span class="header-section-number">4.0.1</span> Generation of
simulation data sets<a class="anchor" aria-label="anchor" href="#generation-of-simulation-data-sets"></a>
</h4>
<p>The simulation input data set is a data.frame, and
<code><a href="../reference/NMsim.html">NMsim()</a></code> returns a data.frame. The input data is a
data.frame that</p>
<ul>
<li>Must contain at least the variables NONMEM will need to run the
model (typically <code>ID</code>, <code>CMT</code>, <code>AMT</code>,
etc. plus covariates)</li>
<li>Can contain character variables (automatically carried to
results)</li>
<li>Column order does not matter</li>
</ul>
<p>There are no requirements to how the data sets are created. NMsim
provides convenient helper functions that can optionally be used. E.g.,
the data set used in these simulations can be created this way:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMcreateDoses.html">NMcreateDoses</a></span><span class="op">(</span>TIME<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">24</span><span class="op">)</span>,AMT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>,<span class="fl">150</span><span class="op">)</span>,</span>
<span>                       addl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ADDL<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,II<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span>,CMT<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dat.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addEVID2.html">addEVID2</a></span><span class="op">(</span><span class="va">doses</span>,time.sim<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fl">24</span><span class="op">*</span><span class="fl">7</span><span class="op">)</span>,CMT<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Notice, <code><a href="../reference/NMcreateDoses.html">NMcreateDoses()</a></code> has convenient behaviours. See
<code><a href="../reference/NMcreateDoses.html">?NMcreateDoses</a></code> for more.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## arguments are expanded - makes loading easy</span></span>
<span><span class="fu"><a href="../reference/NMcreateDoses.html">NMcreateDoses</a></span><span class="op">(</span>TIME<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">24</span>,<span class="fl">36</span><span class="op">)</span>,AMT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["int"],"align":["right"]},{"label":["TIME"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["EVID"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CMT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["AMT"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MDV"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"1","4":"1","5":"2","6":"1"},{"1":"1","2":"12","3":"1","4":"1","5":"1","6":"1"},{"1":"1","2":"24","3":"1","4":"1","5":"1","6":"1"},{"1":"1","2":"36","3":"1","4":"1","5":"1","6":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Different doses by covariate</span></span>
<span><span class="fu"><a href="../reference/NMcreateDoses.html">NMcreateDoses</a></span><span class="op">(</span>TIME<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">24</span><span class="op">)</span>,AMT<span class="op">=</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>AMT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,DOSE<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["int"],"align":["right"]},{"label":["TIME"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["EVID"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CMT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["AMT"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MDV"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["DOSE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"1","4":"1","5":"2","6":"1","7":"1"},{"1":"1","2":"12","3":"1","4":"1","5":"4","6":"1","7":"1"},{"1":"1","2":"24","3":"1","4":"1","5":"4","6":"1","7":"1"},{"1":"2","2":"0","3":"1","4":"1","5":"1","6":"1","7":"2"},{"1":"2","2":"12","3":"1","4":"1","5":"2","6":"1","7":"2"},{"1":"2","2":"24","3":"1","4":"1","5":"2","6":"1","7":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Also, be aware of <code><a href="https://nmautoverse.github.io/NMdata/reference/addTAPD.html" class="external-link">NMdata::addTAPD()</a></code> for adding time
since previous dose:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">addTAPD</span><span class="op">(</span><span class="va">dat.sim</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["int"],"align":["right"]},{"label":["TIME"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["EVID"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CMT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["AMT"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["II"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["ADDL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["MDV"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["DOSCUMN"],"name":[9],"type":["int"],"align":["right"]},{"label":["TPDOS"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["TAPD"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["PDOSAMT"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["DOSCUMA"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"1","4":"1","5":"300","6":"0","7":"0","8":"1","9":"1","10":"0","11":"0","12":"300","13":"300"},{"1":"1","2":"0","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"0","10":"NA","11":"NA","12":"NA","13":"0"},{"1":"1","2":"1","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"1","12":"300","13":"300"},{"1":"1","2":"2","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"2","12":"300","13":"300"},{"1":"1","2":"3","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"3","12":"300","13":"300"},{"1":"1","2":"4","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"4","12":"300","13":"300"},{"1":"1","2":"5","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"5","12":"300","13":"300"},{"1":"1","2":"6","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"6","12":"300","13":"300"},{"1":"1","2":"7","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"7","12":"300","13":"300"},{"1":"1","2":"8","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"8","12":"300","13":"300"},{"1":"1","2":"9","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"9","12":"300","13":"300"},{"1":"1","2":"10","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"10","12":"300","13":"300"},{"1":"1","2":"11","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"11","12":"300","13":"300"},{"1":"1","2":"12","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"12","12":"300","13":"300"},{"1":"1","2":"13","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"13","12":"300","13":"300"},{"1":"1","2":"14","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"14","12":"300","13":"300"},{"1":"1","2":"15","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"15","12":"300","13":"300"},{"1":"1","2":"16","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"16","12":"300","13":"300"},{"1":"1","2":"17","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"17","12":"300","13":"300"},{"1":"1","2":"18","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"18","12":"300","13":"300"},{"1":"1","2":"19","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"19","12":"300","13":"300"},{"1":"1","2":"20","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"20","12":"300","13":"300"},{"1":"1","2":"21","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"21","12":"300","13":"300"},{"1":"1","2":"22","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"22","12":"300","13":"300"},{"1":"1","2":"23","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"23","12":"300","13":"300"},{"1":"1","2":"24","3":"1","4":"1","5":"150","6":"24","7":"5","8":"1","9":"2","10":"24","11":"0","12":"150","13":"450"},{"1":"1","2":"24","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"1","10":"0","11":"24","12":"300","13":"300"},{"1":"1","2":"25","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"1","12":"150","13":"450"},{"1":"1","2":"26","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"2","12":"150","13":"450"},{"1":"1","2":"27","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"3","12":"150","13":"450"},{"1":"1","2":"28","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"4","12":"150","13":"450"},{"1":"1","2":"29","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"5","12":"150","13":"450"},{"1":"1","2":"30","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"6","12":"150","13":"450"},{"1":"1","2":"31","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"7","12":"150","13":"450"},{"1":"1","2":"32","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"8","12":"150","13":"450"},{"1":"1","2":"33","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"9","12":"150","13":"450"},{"1":"1","2":"34","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"10","12":"150","13":"450"},{"1":"1","2":"35","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"11","12":"150","13":"450"},{"1":"1","2":"36","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"12","12":"150","13":"450"},{"1":"1","2":"37","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"13","12":"150","13":"450"},{"1":"1","2":"38","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"14","12":"150","13":"450"},{"1":"1","2":"39","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"15","12":"150","13":"450"},{"1":"1","2":"40","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"16","12":"150","13":"450"},{"1":"1","2":"41","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"17","12":"150","13":"450"},{"1":"1","2":"42","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"18","12":"150","13":"450"},{"1":"1","2":"43","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"19","12":"150","13":"450"},{"1":"1","2":"44","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"20","12":"150","13":"450"},{"1":"1","2":"45","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"21","12":"150","13":"450"},{"1":"1","2":"46","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"22","12":"150","13":"450"},{"1":"1","2":"47","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"23","12":"150","13":"450"},{"1":"1","2":"48","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"2","10":"24","11":"24","12":"150","13":"450"},{"1":"1","2":"49","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"1","12":"150","13":"600"},{"1":"1","2":"50","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"2","12":"150","13":"600"},{"1":"1","2":"51","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"3","12":"150","13":"600"},{"1":"1","2":"52","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"4","12":"150","13":"600"},{"1":"1","2":"53","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"5","12":"150","13":"600"},{"1":"1","2":"54","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"6","12":"150","13":"600"},{"1":"1","2":"55","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"7","12":"150","13":"600"},{"1":"1","2":"56","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"8","12":"150","13":"600"},{"1":"1","2":"57","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"9","12":"150","13":"600"},{"1":"1","2":"58","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"10","12":"150","13":"600"},{"1":"1","2":"59","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"11","12":"150","13":"600"},{"1":"1","2":"60","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"12","12":"150","13":"600"},{"1":"1","2":"61","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"13","12":"150","13":"600"},{"1":"1","2":"62","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"14","12":"150","13":"600"},{"1":"1","2":"63","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"15","12":"150","13":"600"},{"1":"1","2":"64","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"16","12":"150","13":"600"},{"1":"1","2":"65","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"17","12":"150","13":"600"},{"1":"1","2":"66","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"18","12":"150","13":"600"},{"1":"1","2":"67","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"19","12":"150","13":"600"},{"1":"1","2":"68","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"20","12":"150","13":"600"},{"1":"1","2":"69","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"21","12":"150","13":"600"},{"1":"1","2":"70","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"22","12":"150","13":"600"},{"1":"1","2":"71","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"23","12":"150","13":"600"},{"1":"1","2":"72","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"3","10":"48","11":"24","12":"150","13":"600"},{"1":"1","2":"73","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"1","12":"150","13":"750"},{"1":"1","2":"74","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"2","12":"150","13":"750"},{"1":"1","2":"75","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"3","12":"150","13":"750"},{"1":"1","2":"76","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"4","12":"150","13":"750"},{"1":"1","2":"77","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"5","12":"150","13":"750"},{"1":"1","2":"78","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"6","12":"150","13":"750"},{"1":"1","2":"79","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"7","12":"150","13":"750"},{"1":"1","2":"80","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"8","12":"150","13":"750"},{"1":"1","2":"81","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"9","12":"150","13":"750"},{"1":"1","2":"82","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"10","12":"150","13":"750"},{"1":"1","2":"83","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"11","12":"150","13":"750"},{"1":"1","2":"84","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"12","12":"150","13":"750"},{"1":"1","2":"85","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"13","12":"150","13":"750"},{"1":"1","2":"86","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"14","12":"150","13":"750"},{"1":"1","2":"87","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"15","12":"150","13":"750"},{"1":"1","2":"88","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"16","12":"150","13":"750"},{"1":"1","2":"89","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"17","12":"150","13":"750"},{"1":"1","2":"90","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"18","12":"150","13":"750"},{"1":"1","2":"91","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"19","12":"150","13":"750"},{"1":"1","2":"92","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"20","12":"150","13":"750"},{"1":"1","2":"93","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"21","12":"150","13":"750"},{"1":"1","2":"94","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"22","12":"150","13":"750"},{"1":"1","2":"95","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"23","12":"150","13":"750"},{"1":"1","2":"96","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"4","10":"72","11":"24","12":"150","13":"750"},{"1":"1","2":"97","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"1","12":"150","13":"900"},{"1":"1","2":"98","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"2","12":"150","13":"900"},{"1":"1","2":"99","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"3","12":"150","13":"900"},{"1":"1","2":"100","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"4","12":"150","13":"900"},{"1":"1","2":"101","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"5","12":"150","13":"900"},{"1":"1","2":"102","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"6","12":"150","13":"900"},{"1":"1","2":"103","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"7","12":"150","13":"900"},{"1":"1","2":"104","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"8","12":"150","13":"900"},{"1":"1","2":"105","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"9","12":"150","13":"900"},{"1":"1","2":"106","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"10","12":"150","13":"900"},{"1":"1","2":"107","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"11","12":"150","13":"900"},{"1":"1","2":"108","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"12","12":"150","13":"900"},{"1":"1","2":"109","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"13","12":"150","13":"900"},{"1":"1","2":"110","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"14","12":"150","13":"900"},{"1":"1","2":"111","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"15","12":"150","13":"900"},{"1":"1","2":"112","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"16","12":"150","13":"900"},{"1":"1","2":"113","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"17","12":"150","13":"900"},{"1":"1","2":"114","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"18","12":"150","13":"900"},{"1":"1","2":"115","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"19","12":"150","13":"900"},{"1":"1","2":"116","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"20","12":"150","13":"900"},{"1":"1","2":"117","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"21","12":"150","13":"900"},{"1":"1","2":"118","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"22","12":"150","13":"900"},{"1":"1","2":"119","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"23","12":"150","13":"900"},{"1":"1","2":"120","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"5","10":"96","11":"24","12":"150","13":"900"},{"1":"1","2":"121","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"1","12":"150","13":"1050"},{"1":"1","2":"122","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"2","12":"150","13":"1050"},{"1":"1","2":"123","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"3","12":"150","13":"1050"},{"1":"1","2":"124","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"4","12":"150","13":"1050"},{"1":"1","2":"125","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"5","12":"150","13":"1050"},{"1":"1","2":"126","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"6","12":"150","13":"1050"},{"1":"1","2":"127","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"7","12":"150","13":"1050"},{"1":"1","2":"128","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"8","12":"150","13":"1050"},{"1":"1","2":"129","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"9","12":"150","13":"1050"},{"1":"1","2":"130","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"10","12":"150","13":"1050"},{"1":"1","2":"131","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"11","12":"150","13":"1050"},{"1":"1","2":"132","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"12","12":"150","13":"1050"},{"1":"1","2":"133","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"13","12":"150","13":"1050"},{"1":"1","2":"134","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"14","12":"150","13":"1050"},{"1":"1","2":"135","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"15","12":"150","13":"1050"},{"1":"1","2":"136","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"16","12":"150","13":"1050"},{"1":"1","2":"137","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"17","12":"150","13":"1050"},{"1":"1","2":"138","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"18","12":"150","13":"1050"},{"1":"1","2":"139","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"19","12":"150","13":"1050"},{"1":"1","2":"140","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"20","12":"150","13":"1050"},{"1":"1","2":"141","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"21","12":"150","13":"1050"},{"1":"1","2":"142","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"22","12":"150","13":"1050"},{"1":"1","2":"143","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"23","12":"150","13":"1050"},{"1":"1","2":"144","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"6","10":"120","11":"24","12":"150","13":"1050"},{"1":"1","2":"145","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"1","12":"150","13":"1200"},{"1":"1","2":"146","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"2","12":"150","13":"1200"},{"1":"1","2":"147","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"3","12":"150","13":"1200"},{"1":"1","2":"148","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"4","12":"150","13":"1200"},{"1":"1","2":"149","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"5","12":"150","13":"1200"},{"1":"1","2":"150","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"6","12":"150","13":"1200"},{"1":"1","2":"151","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"7","12":"150","13":"1200"},{"1":"1","2":"152","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"8","12":"150","13":"1200"},{"1":"1","2":"153","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"9","12":"150","13":"1200"},{"1":"1","2":"154","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"10","12":"150","13":"1200"},{"1":"1","2":"155","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"11","12":"150","13":"1200"},{"1":"1","2":"156","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"12","12":"150","13":"1200"},{"1":"1","2":"157","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"13","12":"150","13":"1200"},{"1":"1","2":"158","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"14","12":"150","13":"1200"},{"1":"1","2":"159","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"15","12":"150","13":"1200"},{"1":"1","2":"160","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"16","12":"150","13":"1200"},{"1":"1","2":"161","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"17","12":"150","13":"1200"},{"1":"1","2":"162","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"18","12":"150","13":"1200"},{"1":"1","2":"163","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"19","12":"150","13":"1200"},{"1":"1","2":"164","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"20","12":"150","13":"1200"},{"1":"1","2":"165","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"21","12":"150","13":"1200"},{"1":"1","2":"166","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"22","12":"150","13":"1200"},{"1":"1","2":"167","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"23","12":"150","13":"1200"},{"1":"1","2":"168","3":"2","4":"2","5":"NA","6":"NA","7":"NA","8":"1","9":"7","10":"144","11":"24","12":"150","13":"1200"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="section level4" number="4.0.2">
<h4 id="typical-subject-simulation">
<span class="header-section-number">4.0.2</span> Typical subject
simulation<a class="anchor" aria-label="anchor" href="#typical-subject-simulation"></a>
</h4>
<ul>
<li>A typical subject is a subject with all ETAs = 0</li>
<li>Covariates values are supplied using the simulation input data
set</li>
<li>
<code>typical=TRUE</code>: replace all <code>$OMEGA</code> values
with zeros</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simres.typ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="va">file.mod</span>,data<span class="op">=</span><span class="va">data.sim</span>,</span>
<span>                    typical<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4" number="4.0.3">
<h4 id="simulate-multiple-models">
<span class="header-section-number">4.0.3</span> Simulate multiple
models<a class="anchor" aria-label="anchor" href="#simulate-multiple-models"></a>
</h4>
<p>Multiple models can be simulated using the same data set in one
function call by supplying more than one model in the
<code>file.mod</code> argument. The models can be simulated on multiple
data sets by submitting a list of data.frames in the <code>data</code>
argument. NMsim will return one data.frame with all the results for easy
post-processing.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file2.mod.source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples/nonmem/xgxr114.mod"</span>,package<span class="op">=</span><span class="st">"NMsim"</span><span class="op">)</span></span>
<span><span class="co">## file2.mod.source &lt;- "~/wdirs/NMsim/inst/examples/nonmem/xgxr114.mod"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu">fnExtension</span><span class="op">(</span><span class="va">file2.mod.source</span>,<span class="fu">cc</span><span class="op">(</span><span class="va">mod</span>,<span class="va">ext</span>,<span class="va">cov</span>,<span class="va">lst</span>,<span class="va">phi</span><span class="op">)</span><span class="op">)</span>,<span class="va">file.copy</span>,to<span class="op">=</span><span class="st">"models"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file2.mod</span> <span class="op">&lt;-</span> <span class="st">"models/xgxr114.mod"</span></span>
<span><span class="va">simres.typ2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2_compartments"</span><span class="op">=</span><span class="va">file.mod</span>,</span>
<span>                                <span class="st">"1_compartment"</span><span class="op">=</span><span class="va">file2.mod</span><span class="op">)</span>,</span>
<span>                     data<span class="op">=</span><span class="va">data.sim</span>,</span>
<span>                     typical<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## The "model" column is used to distinguish the two models</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">simres.typ2</span>,<span class="va">EVID</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">TIME</span>,<span class="va">PRED</span>,colour<span class="op">=</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="NMsim_poster_examples_files/figure-html/two-models-1.png" alt="Simulation of multiple models and even multiple data sets is handled within one `NMsim()` call." width="100%"><p class="caption">
Simulation of multiple models and even multiple data sets is handled
within one <code><a href="../reference/NMsim.html">NMsim()</a></code> call.
</p>
</div>
</div>
<div class="section level4" number="4.0.4">
<h4 id="emperical-bayes-estimates-known-etas">
<span class="header-section-number">4.0.4</span> Emperical Bayes’
Estimates (known ETAs)<a class="anchor" aria-label="anchor" href="#emperical-bayes-estimates-known-etas"></a>
</h4>
<ul>
<li>By default, automatically re-uses estimated individual ETAs</li>
<li>ID values in simulation data must match the ID values in the
estimation that you want to simulate</li>
<li>Other ETA sources can be specified</li>
<li>Does not simulate residual variability - see
<code><a href="../reference/addResVar.html">addResVar()</a></code> if needed</li>
<li>Remember: Covariates may be needed in data set to fully reproduce
the subjects’ parameters</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## this example uses the same sim data for all subjects</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">NMscanData</span><span class="op">(</span><span class="va">file.mod</span>,quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">data.sim.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data.sim</span>,select<span class="op">=</span><span class="op">-</span><span class="va">ID</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorder</a></span><span class="op">(</span><span class="va">data.sim.ind</span>,<span class="va">ID</span>,<span class="va">TIME</span>,<span class="va">EVID</span><span class="op">)</span></span>
<span><span class="va">simres.ebe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span><span class="va">file.mod</span>,</span>
<span>                    data<span class="op">=</span><span class="va">data.sim.ind</span>,</span>
<span>                    method.sim<span class="op">=</span><span class="va">NMsim_EBE</span>,</span>
<span>                    table.vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CL"</span>,<span class="st">"V2"</span>,<span class="st">"IPRED"</span>,<span class="st">"PRED"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="NMsim_poster_examples_files/figure-html/unnamed-chunk-3-1.png" alt="Individual parameters are confirmed to be identical in estimation results and simulation results" width="100%"><p class="caption">
Individual parameters are confirmed to be identical in estimation
results and simulation results
</p>
</div>
<p> </p>
</div>
<div class="section level4" number="4.0.5">
<h4 id="prediction-intervals">
<span class="header-section-number">4.0.5</span> Prediction
intervals<a class="anchor" aria-label="anchor" href="#prediction-intervals"></a>
</h4>
<p>New subjects can be simulated in multiple ways with NMsim.</p>
<ul>
<li>If the input data set contains multiple subjects, these subjects
will get separate random effects due to NONMEM
<code>$SIMULATION</code>
</li>
<li>The <code>subproblems</code> argument translates to the
<code>SUBPROBLEMS</code> NONMEM subroutine, replicating the simulation
the specified number of times with new seeds</li>
<li>The <code><a href="../reference/simPopEtas.html">simPopEtas()</a></code> function can generate a synthetic .phi
file with a simulated population that can be reused in future
<code><a href="../reference/NMsim.html">NMsim()</a></code> calls. This can be combined with simulation of
covariates in R, allowing reuse of the same subjects across multiple
simulations.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simres.subprob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="va">file.mod</span>,</span>
<span>                        data<span class="op">=</span><span class="va">data.sim</span>,</span>
<span>                        name.sim<span class="op">=</span><span class="st">"Subproblems"</span>,</span>
<span>                        subproblems<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">## data.sim.nsubjs replicates data.sim for each subject,</span></span>
<span><span class="co">## with sampled covariates</span></span>
<span><span class="fu"><a href="../reference/simPopEtas.html">simPopEtas</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="va">file.mod</span>,N<span class="op">=</span><span class="fl">1000</span>,seed<span class="op">=</span><span class="fl">1231</span>,</span>
<span>           file.phi<span class="op">=</span><span class="st">"simres-poster/xgxr021_1000subjs.phi"</span><span class="op">)</span></span>
<span><span class="va">simres.datarep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>file.mod<span class="op">=</span><span class="va">file.mod</span>,</span>
<span>                        data<span class="op">=</span><span class="va">data.sim.nsubjs</span>,</span>
<span>                        method.sim<span class="op">=</span><span class="va">NMsim_EBE</span>,</span>
<span>                        file.phi<span class="op">=</span><span class="st">"simres-poster/xgxr021_1000subjs.phi"</span>,</span>
<span>                        name.sim<span class="op">=</span><span class="st">"datarep"</span><span class="op">)</span></span>
<span><span class="va">simres.newsubjs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">simres.subprob</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">simres.datarep</span><span class="op">)</span>,</span>
<span>                         fill<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### Prediction intervals based on each of the two simulations</span></span>
<span><span class="va">simres.newpops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">simres.subprob</span><span class="op">)</span>,</span>
<span>                        <span class="va">simres.datarep</span>,fill<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="va">EVID</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">simres.pi</span> <span class="op">&lt;-</span> <span class="va">simres.newpops</span><span class="op">[</span></span>
<span>   ,<span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">IPRED</span>,probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>,<span class="fl">.5</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="fu">cc</span><span class="op">(</span><span class="va">ll</span>,<span class="va">median</span>,<span class="va">ul</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">name.sim</span>,<span class="va">trt</span>,<span class="va">TIME</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">simres.pi</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"pi"</span></span>
<span><span class="va">simres.pi</span><span class="op">$</span><span class="va">pi.cover</span> <span class="op">&lt;-</span> <span class="st">"90%"</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">simres.pi</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">TIME</span>,fill<span class="op">=</span><span class="va">trt</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">ll</span>,ymax<span class="op">=</span><span class="va">ul</span>,alpha<span class="op">=</span><span class="va">pi.cover</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">median</span>,colour<span class="op">=</span><span class="va">trt</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_alpha_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"90%"</span><span class="op">=</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name.sim</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Hours since first dose"</span>,y<span class="op">=</span><span class="st">"Concentration (ng/mL)"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="NMsim_poster_examples_files/figure-html/pred-inds-1.png" alt="Prediction intervals. New subjects can be simulated in multiple ways with NMsim. A simulated population can be reused across simulations." width="100%"><p class="caption">
Prediction intervals. New subjects can be simulated in multiple ways
with NMsim. A simulated population can be reused across simulations.
</p>
</div>
</div>
<div class="section level4" number="4.0.6">
<h4 id="configuration-and-important-nmsim-arguments">
<span class="header-section-number">4.0.6</span> Configuration and
Important <code>NMsim()</code> arguments<a class="anchor" aria-label="anchor" href="#configuration-and-important-nmsim-arguments"></a>
</h4>
<p>NMsim must be configured with the path to the NONMEM executable. This
can be done for each <code><a href="../reference/NMsim.html">NMsim()</a></code> call using the
<code>path.nonmem</code> argument, but more easily it can be configured
globally the following way. Also including where NMsim will run NONMEM
and store intermediate files (<code>dir.sims</code>) and where to store
final results (<code>dir.res</code>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nmautoverse.github.io/NMdata/" class="external-link">NMdata</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://nmautoverse.github.io/NMdata/reference/NMdataConf.html" class="external-link">NMdataConf</a></span><span class="op">(</span>path.nonmem <span class="op">=</span> <span class="st">"/opt/NONMEM/nm75/run/nmfe75"</span><span class="op">)</span></span>
<span><span class="co">## or on Windows, it could be</span></span>
<span><span class="fu"><a href="https://nmautoverse.github.io/NMdata/reference/NMdataConf.html" class="external-link">NMdataConf</a></span><span class="op">(</span>path.nonmem <span class="op">=</span> <span class="st">"c:/nm75g64/run/nmfe75.bat"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://nmautoverse.github.io/NMdata/reference/NMdataConf.html" class="external-link">NMdataConf</a></span><span class="op">(</span>dir.sims<span class="op">=</span><span class="st">"simtmp"</span>, <span class="co">## location of sim tmp files</span></span>
<span>           dir.res<span class="op">=</span><span class="st">"simres"</span><span class="op">)</span>  <span class="co">## location of sim results</span></span></code></pre></div>
<p><code><a href="../reference/NMsim.html">NMsim()</a></code> has many features which are explained and
demonstrated in manuals and vignettes. A few often-used arguments
are</p>
<ul>
<li>
<code>table.vars</code>: Redefine the output table. This can
dramatically speed up simulations. E.g.,
<code>table.vars=c("PRED","IPRED")</code>.</li>
<li>
<code>name.sim</code>: Assign a name to the simulation and the
generated files. Keeps order and separates results files between
simulations.</li>
<li>
<code>seed.R</code> and <code>seed.nm</code>: Define seed, either
through R, or directly as the seed used in NONMEM simulation control
stream.</li>
</ul>
</div>
</div>
<div class="section level2" number="5">
<h2 id="references">
<span class="header-section-number">5</span> References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Philip Delff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>



  <script data-goatcounter="https://nmsim.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
